Timer unit: 1e-06 s

Total time: 0.000486283 s
File: /home/lorenzo/miniconda3/envs/devtools_scicomp/lib/python3.9/site-packages/pyclassify/utils.py
Function: majority_vote at line 18

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
    18                                           @profile
    19                                           def majority_vote(neighbors: list[int]) -> int:
    20                                               """
    21                                               This class returns the most common class (expressed as an integer) in a given list of neighbor labels.
    22                                               """
    23       281        486.3      1.7    100.0      return max(set(neighbors), key=neighbors.count)

Total time: 0.194198 s
File: /home/lorenzo/miniconda3/envs/devtools_scicomp/lib/python3.9/site-packages/pyclassify/utils.py
Function: distance at line 8

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
     8                                           @profile
     9                                           def distance(point1: list[float], point2: list[float]) -> float:
    10                                               """
    11                                               This function computes the square of the Euclidean distance between two points.
    12                                               """
    13     19670       4731.6      0.2      2.4      assert len(point1)==len(point2), f"Points have different dimensions: {len(point1)} != {len(point2)}"
    14     19670     189466.1      9.6     97.6      return sum((x - y) ** 2 for x, y in zip(point1, point2))

Total time: 0.244417 s
File: /home/lorenzo/miniconda3/envs/devtools_scicomp/lib/python3.9/site-packages/pyclassify/classifier.py
Function: _get_k_nearest_neighbors at line 18

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
    18                                               @profile
    19                                               def _get_k_nearest_neighbors(self, X: list[list[float]], y: list[int], x: list[float]) -> list[int]:
    20                                                   """
    21                                                   Method to get the k nearest neighbors
    22                                                   """
    23       281     238498.4    848.7     97.6          enumerated_distances = list(enumerate([distance(X_i, x) for X_i in X]))
    24       281       5056.9     18.0      2.1          sorted_distances = sorted(enumerated_distances, key=lambda x: x[1])        
    25                                           
    26       281        466.2      1.7      0.2          k_nearest_neighbors = [index for index, _ in sorted_distances[:self.k]]
    27       281        349.5      1.2      0.1          y_labels = [y[index] for index in k_nearest_neighbors]
    28       281         45.9      0.2      0.0          return y_labels

Total time: 0.247127 s
File: /home/lorenzo/miniconda3/envs/devtools_scicomp/lib/python3.9/site-packages/pyclassify/classifier.py
Function: __call__ at line 31

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
    31                                               @profile
    32                                               def __call__(self, data: tuple[list[list[float]]], new_points: list[list[float]]) -> list[int]:
    33                                                   """
    34                                                   This method returns the predicted labels of a new set of points new_points given a training dataset data=(X, y)
    35                                                   """
    36         1          3.2      3.2      0.0          predicted_labels = []
    37                                           
    38       282         60.7      0.2      0.0          for point in new_points:
    39       281     245807.1    874.8     99.5              closest_neighbors = self._get_k_nearest_neighbors(data[0], data[1], point)
    40       281       1147.5      4.1      0.5              predicted_label = majority_vote(closest_neighbors)
    41       281        108.3      0.4      0.0              predicted_labels.append(predicted_label)
    42         1          0.2      0.2      0.0          return predicted_labels

  0.00 seconds - /home/lorenzo/miniconda3/envs/devtools_scicomp/lib/python3.9/site-packages/pyclassify/utils.py:18 - majority_vote
  0.19 seconds - /home/lorenzo/miniconda3/envs/devtools_scicomp/lib/python3.9/site-packages/pyclassify/utils.py:8 - distance
  0.24 seconds - /home/lorenzo/miniconda3/envs/devtools_scicomp/lib/python3.9/site-packages/pyclassify/classifier.py:18 - _get_k_nearest_neighbors
  0.25 seconds - /home/lorenzo/miniconda3/envs/devtools_scicomp/lib/python3.9/site-packages/pyclassify/classifier.py:31 - __call__
