Timer unit: 1e-06 s

Total time: 0 s
File: /home/lorenzo/miniconda3/envs/devtools_scicomp/lib/python3.9/site-packages/pyclassify/utils.py
Function: distance at line 9

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
     9                                           @profile
    10                                           def distance(point1: list[float], point2: list[float]) -> float:
    11                                               """
    12                                               This function computes the square of the Euclidean distance between two points.
    13                                               """
    14                                               assert len(point1)==len(point2), f"Points have different dimensions: {len(point1)} != {len(point2)}"
    15                                               return sum((x - y) ** 2 for x, y in zip(point1, point2))

Total time: 0 s
File: /home/lorenzo/miniconda3/envs/devtools_scicomp/lib/python3.9/site-packages/pyclassify/utils.py
Function: distance_numba at line 28

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
    28                                           @profile
    29                                           def distance_numba(point1, point2):
    30                                               return distance

Total time: 0.0144843 s
File: /home/lorenzo/miniconda3/envs/devtools_scicomp/lib/python3.9/site-packages/pyclassify/utils.py
Function: majority_vote at line 34

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
    34                                           @profile
    35                                           def majority_vote(neighbors: list[int]) -> int:
    36                                               """
    37                                               This class returns the most common class (expressed as an integer) in a given list of neighbor labels.
    38                                               """
    39      3681      14484.3      3.9    100.0      return max(set(neighbors), key=neighbors.count)

Total time: 8.98346 s
File: /home/lorenzo/miniconda3/envs/devtools_scicomp/lib/python3.9/site-packages/pyclassify/utils.py
Function: distance_numpy at line 19

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
    19                                           @profile
    20                                           def distance_numpy(point1, point2):
    21   3386520    1191765.8      0.4     13.3      assert point1.shape==point2.shape,  f"Points have different dimensions: {point1.shape} != {point2.shape}"
    22   3386520    2801243.9      0.8     31.2      difference = point1 - point2
    23   3386520    4498780.6      1.3     50.1      square_norm = float(np.dot(difference, difference))
    24   3386520     491673.1      0.1      5.5      return square_norm

Total time: 19.7142 s
File: /home/lorenzo/miniconda3/envs/devtools_scicomp/lib/python3.9/site-packages/pyclassify/classifier.py
Function: _get_k_nearest_neighbors at line 22

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
    22                                               @profile
    23                                               def _get_k_nearest_neighbors(self, X, y, x):
    24                                                   """
    25                                                   Method to get the k nearest neighbors
    26                                                   """
    27      3681   18902202.5   5135.1     95.9          enumerated_distances = list(enumerate([self.distance(X_i, x) for X_i in X]))
    28      3681     792588.2    215.3      4.0          sorted_distances = sorted(enumerated_distances, key=lambda x: x[1])        
    29                                           
    30      3681      10896.9      3.0      0.1          k_nearest_neighbors = [index for index, _ in sorted_distances[:self.k]]
    31      3681       7691.1      2.1      0.0          y_labels = [y[index] for index in k_nearest_neighbors]
    32      3681        790.0      0.2      0.0          return y_labels

Total time: 19.8626 s
File: /home/lorenzo/miniconda3/envs/devtools_scicomp/lib/python3.9/site-packages/pyclassify/classifier.py
Function: __call__ at line 35

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
    35                                               @profile
    36                                               def __call__(self, data: tuple[list[list[float]], list[int]], new_points: list[list[float]]) -> list[int]:
    37                                                   """
    38                                                   This method returns the predicted labels of a new set of points new_points given a training dataset data=(X, y).
    39                                                   """
    40         1          0.6      0.6      0.0          predicted_labels = []
    41                                           
    42         1          0.9      0.9      0.0          if self.distance==distance_numpy:
    43         1       2234.4   2234.4      0.0              X_data = [np.array(X_i) for X_i in data[0]]
    44         1       8956.4   8956.4      0.0              _new_points= [np.array(point) for point in new_points] # created for conversion to np arrays
    45                                                   else:
    46                                                       X_data = data[0]
    47                                                       _new_points = new_points
    48         1          1.5      1.5      0.0          y_data = data[1]
    49                                           
    50      3682       1161.8      0.3      0.0          for point in _new_points:
    51      3681   19821063.2   5384.7     99.8              closest_neighbors = self._get_k_nearest_neighbors(X_data, y_data, point)
    52      3681      26750.7      7.3      0.1              predicted_label = majority_vote(closest_neighbors)
    53      3681       2427.0      0.7      0.0              predicted_labels.append(predicted_label)
    54                                           
    55         1          0.2      0.2      0.0          return predicted_labels

  0.00 seconds - /home/lorenzo/miniconda3/envs/devtools_scicomp/lib/python3.9/site-packages/pyclassify/utils.py:9 - distance
  0.00 seconds - /home/lorenzo/miniconda3/envs/devtools_scicomp/lib/python3.9/site-packages/pyclassify/utils.py:28 - distance_numba
  0.01 seconds - /home/lorenzo/miniconda3/envs/devtools_scicomp/lib/python3.9/site-packages/pyclassify/utils.py:34 - majority_vote
  8.98 seconds - /home/lorenzo/miniconda3/envs/devtools_scicomp/lib/python3.9/site-packages/pyclassify/utils.py:19 - distance_numpy
 19.71 seconds - /home/lorenzo/miniconda3/envs/devtools_scicomp/lib/python3.9/site-packages/pyclassify/classifier.py:22 - _get_k_nearest_neighbors
 19.86 seconds - /home/lorenzo/miniconda3/envs/devtools_scicomp/lib/python3.9/site-packages/pyclassify/classifier.py:35 - __call__
